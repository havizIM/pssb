<!-- Form wizard with icon tabs section start -->
        <section id="icon-tabs">
          <div class="row">
            <div class="col-12">
              <div class="card">
                <div class="card-header">
                  <h4 class="card-title">Form Pendaftaran Murid Baru</h4>
                </div>
                <div class="card-content collapse show">
                  <div class="card-body">
                    <form action="#" class="icons-tab-steps wizard-notification wizard clearfix" id="form_pendaftaran">
                      <!-- Step 1 -->
                      <h6> Data Siswa</h6>
                      <fieldset>
                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group">
                              <label>Nama Lengkap :</label>
                              <input type="text" class="form-control" id="nama_lengkap" name="nama_lengkap">
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-group">
                              <label>NIK :</label>
                              <input type="text" class="form-control" id="nik" name="nik">
                            </div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group">
                              <label>Email :</label>
                              <input type="email" class="form-control" id="email" name="email">
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="row">
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label>Jenis Kelamin :</label>
                                  <select class="c-select form-control" id="jenis_kelamin" name="jenis_kelamin">
                                    <option value="">-</option>
                                    <option value="Laki-laki">Laki-laki</option>
                                    <option value="Perempuan">Perempuan</option>
                                  </select>
                                </div>
                              </div>
                              <div class="col-md-6">
                                 <div class="form-group">
                                  <label>Agama :</label>
                                  <select class="c-select form-control" id="agama" name="agama">
                                    <option value="">-</option>
                                    <option value="Islam">Islam</option>
                                    <option value="Protestan">Protestan</option>
                                    <option value="Katholik">Katholik</option>
                                    <option value="Hindu">Hindu</option>
                                    <option value="Budha">Buddha</option>
                                  </select>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group">
                              <label>No Handphone :</label>
                              <input type="tel" class="form-control" id="no_hp" name="no_hp">
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-group">
                              <label>Tempat Tgl Lahir :</label>
                              <div class="row">
                                  <div class="col-md-6">
                                     <input type="text" class="form-control" id="tmp_lahir" name="tmp_lahir">
                                  </div>
                                  <div class="col-md-6">
                                     <input type="date" class="form-control" id="tgl_lahir" name="tgl_lahir">
                                  </div>
                              </div>

                            </div>
                          </div>
                        </div>

                        <div class="row ">
                          <div class="col-md-6">
                            <div class="row">
                                <div class="col-md-6">
                                  <div class="form-group">
                                    <label>Alat Transportasi :</label>
                                    <select class="c-select form-control" id="alat_transportasi" name="alat_transportasi">
                                      <option value="">-</option>
                                      <option value="Jalan Kaki">Jalan Kaki</option>
                                      <option value="Motor">Motor</option>
                                      <option value="Angkutan Umum">Angkutan Umum</option>
                                    </select>
                                  </div>
                                </div>
                                <div class="col-md-6">
                                   <div class="form-group">
                                    <label>Jenis Tempat Tinggal :</label>
                                    <select class="c-select form-control" id="jenis_tmp_tinggal" name="jenis_tmp_tinggal">
                                      <option value="">-</option>
                                      <option value="Bersama Orang Tua">Bersama Orang Tua</option>
                                      <option value="Bersama Wali">Bersama Wali</option>
                                      <option value="Pondok Pesantren">Pondok Pesantren</option>
                                    </select>
                                  </div>
                                </div>
                              </div>
                              
                          </div>
                          <div class="col-md-6">
                            <div class="row">
                              <div class="col-md-6">
                                 <div class="form-group">
                                    <label>Ekstrakulikuler :</label>
                                    <select class="c-select form-control" id="ekstrakulikuler" name="ekstrakulikuler">
                                      <option value="">-</option>
                                      <option value="Sepak Bola">Sepak Bola</option>
                                      <option value="Volly">Volly</option>
                                      <option value="Badminton">Badminton</option>
                                      <option value="Bela Diri">Bela Diri</option>
                                      <option value="Pramuka">Pramuka</option>
                                      <option value="Paskibra">Paskibra</option>
                                    </select>
                                  </div>
                              </div>
                              <div class="col-md-6">
                                <div class="form-group">
                                  <label>Asal Sekolah :</label>
                                  <input type="text" class="form-control" id="asal_sekolah" name="asal_sekolah">
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                          
                        <div class="row">
                            <div class="col-md-6">
                            <div class="row">
                              <div class="col-md-4">
                                <div class="form-group">
                                  <label>Golongan Darah :</label>
                                  <select class="c-select form-control" id="gol_darah" name="gol_darah">
                                      <option value="">-</option>
                                      <option value="A">A</option>
                                      <option value="B">B</option>
                                      <option value="AB">AB</option>
                                      <option value="O">O</option>
                                    </select>
                                </div>
                              </div>
                              <div class="col-md-4">
                                <div class="form-group">
                                  <label>Tinggi Badan :</label>
                                  <input type="number" class="form-control" id="tinggi_badan" name="tinggi_badan">
                                </div>
                              </div>
                              <div class="col-md-4">
                                <div class="form-group">
                                  <label>Berat Badan :</label>
                                  <input type="number" class="form-control" id="berat_badan" name="berat_badan">
                                </div>
                              </div>
                            </div>
                          </div>

                          <div class="col-md-6">
                            <div class="row">
                              <div class="col-md-6">
                                <div class="form-group">
                                    <label>Anak ke :</label>
                                    <input type="number" class="form-control" id="anak_ke" name="anak_ke">
                                </div>
                              </div>
                              <div class="col-md-6">
                                  <div class="form-group">
                                    <label>Jumlah Saudara :</label>
                                    <input type="number" class="form-control" id="jml_saudara" name="jml_saudara">
                                  </div>
                              </div>
                            </div>
                          </div>
                        </div>
                          
                       <div class="row">
                            <div class="col-md-6">
                              <div class="form-group">
                                <label>NISN :</label>
                                <input type="text" class="form-control" id="nisn" name="nisn">
                              </div>
                            </div>

                          <div class="col-md-6">
                            <div class="form-group">
                              <label>No. UN :</label>
                              <input type="text" class="form-control" id="no_un" name="no_un">
                            </div>
                          </div>
                        </div>
                          
                        <div class="row">
                            <div class="col-md-6">
                            <div class="form-group">
                              <label>SKHUN:</label>
                              <input type="text" class="form-control" id="no_skhun" name="no_skhun">
                            </div>
                          </div>

                          <div class="col-md-6">
                            <div class="form-group">
                              <label>No. Ijazah :</label>
                              <input type="text" class="form-control" id="no_ijazah" name="no_ijazah">
                            </div>
                          </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                            <div class="form-group">
                              <label>KIP:</label>
                              <select name="kip" id="kip" class="form-control">
                                <option value="">-</option>
                                <option value="Y">Y</option>
                                <option value="T">T</option>
                              </select>
                            </div>
                          </div>
                        </div>
                          
                      </fieldset>


                      <!-- Step 2 -->
                      <h6>Alamat</h6>
                      <fieldset>
                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group">
                                <label>Alamat :</label>
                                <textarea name="alamat" id="alamat2" name="shortDescription2" rows="8" class="form-control"></textarea>
                            </div>
                            <div class="form-group">
                              <label>RT/RW :</label>
                              <input type="text" class="form-control" id="rtrw" name="rtrw">
                            </div>
                            <div class="form-group">
                              <label>Kode Pos</label>
                              <input type="text" class="form-control" id="kode_pos" name="kode_pos">
                            </div>
                            
                          </div>
                          <div class="col-md-6">
                            <div class="form-group">
                                <label>Provinsi :</label>
                                <select class="select2 form-control" id="id_provinsi" name="id_provinsi">
                                    
                                </select>
                            </div>
                            <div class="form-group">
                              <label>Kota :</label>
                              <select class="select2 form-control" id="id_kota" name="id_kota">
                                  
                              </select>
                            </div>
                            <div class="form-group">
                                <label>Kecamatan :</label>
                                <select class="select2 form-control" id="id_kecamatan" name="id_kecamatan">
                                   
                                </select>
                            </div>
                            
                            <div class="form-group">
                              <label>Kelurahan :</label>
                              <select class="select2 form-control" id="id_kelurahan" name="id_kelurahan">
                                  <option value=""></option>
                              </select>
                            </div>
                            </div>
                        </div>
                      </fieldset>

                      <!-- Step 3 -->
                      <h6>Data Orang Tua</h6>
                      <fieldset>
                        <div class="row">
                            <div class="col-md-6">
                                <h2>Data Ayah</h2>
                                <div class="form-group">
                                <label>NIK :</label>
                                <input type="text" class="form-control" id="nik_ayah" name="nik_ayah">
                                </div>
                                <div class="form-group">
                                <label>Nama Ayah :</label>
                                <input type="text" class="form-control" id="nama_ayah" name="nama_ayah">
                                </div>
                                <div class="form-group">
                                  <label>Tempat & Tgl Lahir :</label>
                                  <div class="row">
                                      <div class="col-md-6">
                                        <input type="text" class="form-control" id="tmp_lahir_ayah" name="tmp_lahir_ayah">
                                      </div>
                                      <div class="col-md-6">
                                        <input type="date" class="form-control" id="tgl_lahir_ayah" name="tgl_lahir_ayah">
                                      </div>
                                  </div>
                                </div>
                                <div class="form-group">
                                <label>Pekerjaan :</label>
                                <input type="text" class="form-control" id="pekerjaan_ayah" name="pekerjaan_ayah">
                                </div>
                                <div class="form-group">
                                <label>Pendidikan Terakhir :</label>
                                    <select class="c-select form-control" id="pendidikan_ayah" name="pendidikan_ayah">
                                      <option value="">-</option>
                                      <option value="SD">SD</option>
                                      <option value="SMP">SMP</option>
                                      <option value="SMA/SMK">SMA/SMK</option>
                                      <option value="D3">D3</option>
                                      <option value="S1">S1</option>
                                      <option value="S2">S2</option>
                                      <option value="S3">S3</option>
                                    </select>
                                  </div>
                                <div class="form-group">
                                <label>Penghasilan Perbulan :</label>
                                    <input type="text" class="form-control" id="penghasilan_ayah" name="penghasilan_ayah">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h2>Data Ibu</h2>
                                <div class="form-group">
                                <label>NIK :</label>
                                <input type="text" class="form-control" id="nik_ibu" name="nik_ibu">
                                </div>
                                <div class="form-group">
                                <label>Nama Ibu :</label>
                                <input type="text" class="form-control" id="nama_ibu" name="nama_ibu">
                                </div>
                                 <div class="form-group">
                                  <label>Tempat & Tgl Lahir :</label>
                                  <div class="row">
                                      <div class="col-md-6">
                                        <input type="text" class="form-control" id="tmp_lahir_ibu" name="tmp_lahir_ibu">
                                      </div>
                                      <div class="col-md-6">
                                        <input type="date" class="form-control" id="tgl_lahir_ibu" name="tgl_lahir_ibu">
                                      </div>
                                  </div>
                                </div>
                                <div class="form-group">
                                <label>Pekerjaan :</label>
                                <input type="text" class="form-control" id="pekerjaan_ibu" name="pekerjaan_ibu">
                                </div>
                                <div class="form-group">
                                <label>Pendidikan Terakhir :</label>
                                    <select class="c-select form-control" id="pendidikan_ibu" name="pendidikan_ibu">
                                      <option value="">-</option>
                                      <option value="SD">SD</option>
                                      <option value="SMP">SMP</option>
                                      <option value="SMA/SMK">SMA/SMK</option>
                                      <option value="D3">D3</option>
                                      <option value="S1">S1</option>
                                      <option value="S2">S2</option>
                                      <option value="S3">S3</option>
                                    </select>
                                  </div>
                                <div class="form-group">
                                <label>Penghasilan Perbulan :</label>
                                    <input type="text" class="form-control" id="penghasilan_ibu" name="penghasilan_ibu">
                                </div>
                            </div>
                        </div>
                      </fieldset>
                      <!-- Step 4 -->
                      <h6>Dokumen</h6>
                      <fieldset>
                        <div class="row">
                          <div class="col-md-6">
                            <div class="form-group">
                                <label class="m-b-10">Ijazah</label>
                                <div class="input-group">
                                    <input type="file" class="form-control" id="ijazah" name="ijazah">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="m-b-10">SKHUN</label>
                                <div class="input-group">
                                    <input type="file" class="form-control" id="skhun" name="skhun">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="m-b-10">KK</label>
                                <div class="input-group">
                                    <input type="file" class="form-control" id="kk" name="kk">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="m-b-10">KTP Ayah</label>
                                <div class="input-group">
                                    <input type="file" class="form-control" id="ktp_ayah" name="ktp_ayah">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="m-b-10">KTP Ibu</label>
                                <div class="input-group">
                                    <input type="file" class="form-control" id="ktp_ibu" name="ktp_ibu">
                                </div>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-group">
                                <label class="m-b-10">KTP Wali</label>
                                <div class="input-group">
                                    <input type="file" class="form-control" id="ktp_wali" name="ktp_wali">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="m-b-10">Fotocopy KIP</label>
                                <div class="input-group">
                                    <input type="file" class="form-control" id="fc_kip" name="fc_kip">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="m-b-10">Foto</label>
                                <div class="input-group">
                                    <input type="file" class="form-control" id="foto" name="foto">
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="m-b-10">Surat Keterangan Baik</label>
                                <div class="input-group">
                                    <input type="file" class="form-control" id="sk_baik" name="sk_baik">
                                </div>
                            </div>

                            
                            <div class="form-group">
                                <label class="m-b-10">Sertifikat</label>
                                <div class="input-group">
                                    <input type="file" class="form-control" id="sertifikat" name="sertifikat">
                                </div>
                            </div>
                          </div>
                        </div>
                      </fieldset>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <!-- Form wizard with icon tabs section end -->

        <script>
            var renderUI = (function(){
        
        return {
            renderTA: function(data){
                var html = '';
                html += `
               
                `
            },

            renderNoData: function(){
               var html = "";

               html += `
               `
            },

            renderProvinsi: function(data){
              var html = `<option value=""> Pilih Provinsi</option>`

            
                $.each(data, function(k, v){
                    // console.log(v.id)
                  html+= `
                    <option value="${v.id}">${v.nama_provinsi}</option>
                  `
                })
              $('#id_provinsi').html(html);
            },

            renderKota: function(data) {
              var html = `<option value=""> Pilih Kota</option>`

              $.each( data, function(k, v){
                html += `
                  <option value="${v.id}">${v.nama_kabupaten}</option>
                ` 

              })
              $('#id_kota').html(html)
            },

            renderKecamatan: function(data) {
              var html = `<option value=""> Pilih Kecamatan</option>`

              $.each( data, function(k, v){
                html += `
                  <option value="${v.id}">${v.nama_kecamatan}</option>
                ` 

              })
              $('#id_kecamatan').html(html)
            },

            renderKelurahan: function(data) {
              var html = `<option value=""> Pilih Kota</option>`

              $.each( data, function(k, v){
                html += `
                  <option value="${v.id}">${v.nama_kelurahan}</option>
                ` 

              })
              $('#id_kelurahan').html(html)
            }

            
        }

    })()

 var loadData = (function(UI){
        var form = $('#form_pendaftaran')
        var kd_ta = location.hash.substr(14);
        
        var setupStep = function(){
            form.steps({
                headerTag: "h6",
                bodyTag: "fieldset",
                transitionEffect: "fade",
                titleTemplate: '<span class="step">#index#</span> #title#',
                labels: {
                finish: "Simpan"
                },
                // onStepChanging: function (event, currentIndex, newIndex)
                // {   
                //     if (currentIndex > newIndex)
                //     {
                //         return true;
                //     }

                //     form.validate().settings.ignore = ":disabled,:hidden";
                //     return form.valid();
                // },
                onFinishing: function (event, currentIndex)
                {
                    form.validate().settings.ignore = ":disabled";
                    return form.valid();
                },
                onFinished: function (event, currentIndex)
                {
                    form.submit();
                }
            })
        }

        var submitForm = function(){
            $('#form_pendaftaran').on('submit', function(e){
                e.preventDefault();

                $.ajax({
                    url: `<?= base_url('public/pendaftaran/add/') ?>?kd_ta=${kd_ta}`,
                    type: 'POST',
                    dataType: 'JSON',
                    data: new FormData(this),
                    processData:false,
                    contentType:false,
                    success: function(response){
                        if(response.status === 200){
                          Swal.fire({
                            position: 'center',
                            type: 'success',
                            title: response.message,
                            showConfirmButton: false,
                            timer: 1500
                          })
                          location.hash = '#/pendaftaran';
                        } else {
                         Swal.fire({
                            position: 'center',
                            type: 'warning',
                            title: response.message,
                            showConfirmButton: false,
                            timer: 1500
                          })
                        }

                    },
                    error: function(err){
                       Swal.fire({
                            position: 'center',
                            type: 'warning',
                            title: 'Tidak dapat mengakses server',
                            showConfirmButton: false,
                            timer: 1500
                        })
                    }
                })
            });
        }

        var selectProvinsi = function() {
        $.ajax({
            url:`<?= base_url('public/pendaftaran/provinsi/') ?>`,
            type:'GET',
            dataType:'JSON',
            success: function(response){
                  UI.renderProvinsi(response.data)
                  
            }

          });
        }

        var provinsiOnChange = function(){
          $('#id_provinsi').on('change', function(){
            var id_provinsi = $(this).val();
            if (id_provinsi === '') {
              $('#id_kota').html('')
            } else {
              selectKota(id_provinsi)
            }
          
          })
        }

        var selectKota = function(id_provinsi){
          $.ajax({
            url:`<?= base_url('public/pendaftaran/kabupaten/') ?>?id_provinsi=${id_provinsi}`,
            type: `GET`,
            dataType: `JSON`,
            success: function(response){
              UI.renderKota(response.data)
              
            }
          })
        }

        var kotaOnChange = function(){
          $('#id_kota').on('change', function(){
            var id_kota = $(this).val();
            if (id_kota === '') {
              $('#id_kecamatan').html('')
            } else {
              selectKecamatan(id_kota)
            }
          
          })
        }

        var selectKecamatan = function(id_kota){
          $.ajax({
            url:`<?= base_url('public/pendaftaran/kecamatan/') ?>?id_kabupaten=${id_kota}`,
            type: `GET`,
            dataType: `JSON`,
            success: function(response){
              UI.renderKecamatan(response.data)
              
            }
          })
        }

        var kecamatanOnChange = function(){
          $('#id_kecamatan').on('change', function(){
            var id_kecamatan = $(this).val();
            if (id_kecamatan === '') {
              $('#id_kelurahan').html('')
            } else {
              selectKelurahan(id_kecamatan)
            }
          
          })
        }

        var selectKelurahan = function(id_kecamatan){
          $.ajax({
            url:`<?= base_url('public/pendaftaran/kelurahan/') ?>?id_kecamatan=${id_kecamatan}`,
            type: `GET`,
            dataType: `JSON`,
            success: function(response){
              UI.renderKelurahan(response.data)
            }
          })
        }

        

        var setupFile = function () {
        $(document).on('change', ':file', function () {
            var input = $(this),
                numFiles = input.get(0).files ? input.get(0).files.length : 1,
                label = input.val().replace(/\\/g, '/').replace(/.*\//, '');
            input.trigger('fileselect', [numFiles, label]);
        });

        $(document).ready(function () {
            $(':file').on('fileselect', function (event, numFiles, label) {

                var input = $(this).parents('.input-group').find(':text'),
                    log = numFiles > 1 ? numFiles + ' files selected' : label;

                if (input.length) {
                    input.val(log);
                } else {
                    if (log) alert(log);
                }

            });
        });
    }


       
        return {
            init : function(){
                setupStep();
                selectProvinsi();
                provinsiOnChange()
                kotaOnChange()
                kecamatanOnChange()
                submitForm()
            }
        }

    })(renderUI)

    $(document).ready(function(){
        loadData.init();
    })
 



        
        </script>